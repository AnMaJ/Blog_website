<!DOCTYPE html>
<html>
    <%- include('./partials/head.ejs')%>
    <body>
        <%- include('./partials/nav.ejs')%>
        <div class="Blogs content">
            <h2>
                Login Page
            </h2>
            <form class="create-user content">
                <label for="email">Email</label>
                <input type="text" name="email" required />
                <div class="email error"></div>

                <label for="password">Password</label>
                <input type="password" name="password" required />
                <div class="password error"></div>

                <button>LOGIN</button>
            </form>
        </div>

        <script>
            const form=document.querySelector('form');
            const emailError = document.querySelector('.email.error');
            const passwordError = document.querySelector('.password.error');

            form.addEventListener('submit', async (e)=>{
                e.preventDefault();
                emailError.textContent='';
                passwordError.textContent='';
                //usernameError.textContent='';
                //ageError.textContent='';
                const email=form.email.value;
                const password=form.password.value;
                //const username=form.Username.value;
                //const age=form.age.value;
                console.log(email, password);
                try{
                    const res = await fetch('/login',{
                        method: 'POST',
                        body: JSON.stringify({email: email, password: password}),
                        headers: {'Content-Type': 'application/json'}
                    });
                    const data= await res.json();
                    console.log(data);
                    if(data.errors){
                        emailError.textContent=data.errors.email;
                        passwordError.textContent=data.errors.password;
                        //usernameError.textContent=data.errors.username;
                        //ageError.textContent=data.errors.age;
                    }
                    if(data.user){
                        location.assign('/');
                    }
                }catch (error){
                    console.log(error);
                }
            })
        </script>
        <%- include("./partials/footer.ejs") %>
        <script src="" async defer></script>
    </body>
</html>